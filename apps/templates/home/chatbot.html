{% extends "layouts/base.html" %}

{% block content %}

    <h1>Chatbot Here!</h1>
    <input type="text" id="user-input">
    <button type="submit" onclick="sendMessage()">Submit</button>
    <br/>
    <p id="chat-log"></p>

    <script>
        function sendMessage() {
            var userMessage = document.getElementById("user-input").value;
            appendMessage("You: " + userMessage);
    
            // Use AJAX to send the userMessage to the server
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/get_response", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var botResponse = JSON.parse(xhr.responseText).bot_response;
                    appendMessage("SimpleBot: " + botResponse);
                }
            };
            xhr.send("user_message=" + userMessage);
    
            document.getElementById("user-input").value = "";
        }
    
        function appendMessage(message) {
            var chatLog = document.getElementById("chat-log");
            chatLog.innerHTML += "<p>" + message + "</p>";
        }
    </script>

{% endblock content %}
